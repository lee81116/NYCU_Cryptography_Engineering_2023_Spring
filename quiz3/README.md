# Cryptography Engineering Quiz3
## Overview
In this program, our aim is to crack a Vigener cipher. We first need to determine the keyword length of encrypted messages by using I.C. Then we can solve the keyword letters by using the CHi-Square test. At last, we break the ciphertext and recover the plaintext.  
## Environment
python 3.8.7
## ScreenShot
On the left of the screenshot is the original cipher text. And on the right is the output of my program, which represents the key length, key, and the plain text of the cipher text.

 ![](https://i.imgur.com/2dkARae.png)
## Usage
#### To run the program:
`python 109550117.py`

As the program running, type in the cipher text you want.
#### To run the program with file redirection:
`python 109550117.py < {filename}.txt`
## Source Code
There are two files in my program including 109550117.py and quiz3.py. In 109550117.py we handle the main process with stdin and stdout, while in quiz3  we define the functions are used. I will go through the functions to show the way I implemented them.

    def get_ic(message, key_length)
This is the function to calculate the I.C. value for certain key length. Since the the message would be devided into {key_length} groups, I first count the number of each letters and total letters of each groups. Then, get the average I.C. value of the groups by calculating it with the formula.

    def try_key_length(message)
This function will calculate the I.C. values of key length where 2<=length<=8. Then, it returns the the key length whose I.C is the nearest to English plain text (0.667).

    def get_key(message, k)
This function is aim to find the key alphabet for each group, then cacatenate them into the answer key word. To apply the Chi-Square test, I use the average appear frequency of each alphabet as the expected value. The key alphabet would be the one with the lowest Chi-Square test score.

    def get_plain(message, key):
        plain_text = ""
        for i in range(len(message)):
            k = ord(key[i % len(key)])
            l = ord(message[i])
            plain_text += chr(((l-k+26)%26) + ord("A"))
        return plain_text
Since the length of this function is short, the full code is shown as above. This function substitutes the cipher text by deciphered letters and returns the plain text.
## Experiment
I have performed two tests, which are listed below:
#### Ciphered text
message 1

    ZQQTKPQUWDPGMWDBQTXYLFQWLSHAJBUCIPVKUQEJRBAACLRSIZZCRWTLDFMTPGYXFISOSEASZXNPHTAYHHIIRADDIJLBFOEVKUWWVFFLVTCEXGHFFXFZVGXFBFQEIZOSEZUGFGFUJUGKPCZWZUQQJIVAFLVCSDCXYOPYRSQTEIHQFIIVTAYILRGGRAWARNLAGWKJCZXZUIMPCFTAVXLHMRULAMRTPDMXVVIDWVSJQWWYCYOEVKXIUNSBVVCWAYJSMMGHBWDIUDSYYJAGQXRZWPIFSRZSKPCZWRURQQSYOOIWYSELFUSEEEKOEAVSSMVEDSYYJAPQHRPZKYESSMVEPBSWFTSFLZUUILZJVUXYHGOSJAIERFZAMPCSONSLYOZHRULUIKFHAETXIUVVHBPXYPGPMWMWOYCAMMXKHQTIJPHEICMAAVVJZAWVSMFSRUOSIZUKTMTODDSXYSEWYHGSEZUSPEJAFARXHGOIEKSZGPVJQVGYSVYUPQQEEKWZAYPQTTVYGARJHBPXYPBSWRYSPEPIMPEPMWZHZUUFLVPFDIRSZQZVSWZPZLIAJKOSUVTVBHIEAWARRSJMPLLHTIJHAQTIPBOMGSSEAYPQTLRCSEAVWHMARFHDEUPHUSEHZMFLZSEEEKKTMTOODIDHYURXYOBMUOOHSTHAARXAVQVVCSZYVZCRWZUSOYIPGFWRUREXIPDBMENHTIKOWZXRDRDCMLWXJIVAMXKYOOXZCSEYGLFEXZAWARJHFQAFYYURXHGMGKPJQPPPBXMKLFMXLYSMWZUGAGZLHKXYLQDIUBZUXPVTARVDFUXVYCDXYLDMVKPOXMKFCREEVHTIIMWZHJHGBSNLFRYCHHAYTOGFSELOZHRZKTSCLGAQVHQTEJAWEIDLBFMEAVQLVHZFLPZQQTKPQUWDVTMXVTDQVRASOPRZGAJRUHMKFUWEXJHGFLVKFQEDZCRGFUGQVMHHUWDVFFLVPABSJAIDIJVTBPLYOXMJAGURVJIDIJPBFLVJVGVTOVUWKVFKEEKHDEUPHUSEDVQXYLFAJRUQUIEACDGFTDMVRAWHICFFQGVUHFMDLGMVVZINNVJHQHKVJQVPKWRJVYSZXYHBPPZUURVFTHTEKDVUGYAVQMEKIXKVUQQSIJFQHLSWFCFMTAVDLFMKVZQAYCKOXPFDAQVVZHMXVTSZXJHFQNVHZAYJSMIEKJVQHRURFLVTCFMMLGAJKOSIVZASDJFYAMWZTDAVKHBFEEPBSVVKWQRKPBFLVHBMPPZWESWOWELZZHAVPHGFLVMOOXJOSDITVFPWGYCNESPZUXPPGMTFDSDJLSOZHKYCGFCLGAQVASEXRURUXZZPKXYPGFVFBPXIJVAQWKHBPEIKHTEKHZMVXLDAVKPCZSWOWEXFYWOECLJUHVUQQMJZWRXVKQARJPGFIEJMUWEVZQWJWSDXZUOOMFBGMRULLMGKPBSMEPHEHVTOZHJPBNVZLTFSNYWFIROWEXFYMIIDBGFOEVKYSILHTEETSDIWHQFWYBAMREHHGVVCWQAVKIZHVYOZMEKIOXZVBAJVEHQRULRQBGLFUIEJSUWKOSNIJAVQPGACFLVJFUXZJWEQFMVGQRUVUWKVFKLZZHAVZJOXGYHFMGKLFEGRUCZPPISQWKPAMXVKPKXYLGFEEKODHNOWOLYBAMRVEDQVZLBOINOSFLVYOOXLHZAVKYOPMKPCZEIFVMWWBFZMJOSPXFMCDQTVFDITAJUINZCRMEKWHMUBOXWNLAGWKYSSEIKHTIDHGRSITWZKGHFFWFMOSVVHHILFSSIIDBGFQVHGGVVAVQQSFHTIZYFQPRAWARKVHTIDHGESWISURXZPKAYVAFLVFODIJBFDSLURQHRURURTVBFIDWZMXZUUFLVPBOMULBFWZUHTIZYZUZVZCDGFURUXZVBILZJVFVRKWFMFUVMWYHBPIUKCIRKVIEAVTIEXIHHTIIJCZWZKSDXYLUQRVYOXFVHFURXVTFLVDVAPVUODVRAWHIKOOZXYLFQWGLQFMMLDDSSHPUPZAMAJZAGPIKHWXW
message 2

    IVIKDKDQMJGLPWLZGMPFBJIIDBBYSLJDXFGBIWWEHAPHEYSGNCCYOOTSTZABCOBVRTAZEYWVWWAZAIDGAZPETHPVBPWOBVJXGFMDOBCGPFKXKSZZAIGCJRPETACJHUTHPVHKJHPZHFPMEVZEQSBYOMHSDVFTASFGZTCOBZCGHFMDOBCWVNVBRVKRGXDBMKFBTGBVGMPTBVFMTGBLBMXZWESHGCBYSKDTBYSFWOARQHCJQEQBCUIDCNCHWWGNEDWIHPTKQCZGDKIGDENHPZGIGWVTWIASBFHATQIJSBCDWZBMPGQKKTHTQIGMEFMJSGISLKCFTHPVFXLSZVHAGSMGCLHWJCSXMDTRBTIWWEGHUHPVGXRZCJWHCCZZBVPFKVFTIWWECYIVQJUXCHTVATCWVRBHJHPFILTCNYWLUOBYSKHAIEGBDBBYSKTKIJHATSFGZTCOBZCGIVIKVXLOAZBAXRQEUYDFITFBBSWIHAPHPVKTHAIUOGSHPRHMWSGNWLWSLKCTKCQUOGPGGCIFDFBYOMWSPRRLDAMUWLTOAVKAXQPTONHSLYWLHSOISZPHQFBBRCCCRMWWVBCYCCWKVXGOLVENPHMJCEJHQFBLIVMJSMWSVYOWICJVGBUHMUOGSPICOGRSLRUTXBAKSTRVWKVXG
#### Results
For message 1, its key is "HOMER", and the plain text:

    SCEPTICISMISASMUCHTHERESULTOFKNOWLEDGEASKNOWLEDGEISOFSCEPTICISMTOBECONTENTWITHWHATWEATPRESENTKNOWISFORTHEMOSTPARTTOSHUTOUREARSAGAINSTCONVICTIONSINCEFROMTHEVERYGRADUALCHARACTEROFOUREDUCATIONWEMUSTCONTINUALLYFORGETANDEMANCIPATEOURSELVESFROMKNOWLEDGEPREVIOUSLYACQUIREDWEMUSTSETASIDEOLDNOTIONSANDEMBRACEFRESHONESANDASWELEARNWEMUSTBEDAILYUNLEARNINGSOMETHINGWHICHITHASCOSTUSNOSMALLLABOURANDANXIETYTOACQUIREANDTHISDIFFICULTYATTACHESITSELFMORECLOSELYTOANAGEINWHICHPROGRESSHASGAINEDASTRONGASCENDENCYOVERPREJUDICEANDINWHICHPERSONSANDTHINGSAREDAYBYDAYFINDINGTHEIRREALLEVELINLIEUOFTHEIRCONVENTIONALVALUETHESAMEPRINCIPLESWHICHHAVESWEPTAWAYTRADITIONALABUSESANDWHICHAREMAKINGRAPIDHAVOCAMONGTHEREVENUESOFSINECURISTSANDSTRIPPINGTHETHINTAWDRYVEILFROMATTRACTIVESUPERSTITIONSAREWORKINGASACTIVELYINLITERATUREASINSOCIETYTHECREDULITYOFONEWRITERORTHEPARTIALITYOFANOTHERFINDSASPOWERFULATOUCHSTONEANDASWHOLESOMEACHASTISEMENTINTHEHEALTHYSCEPTICISMOFATEMPERATECLASSOFANTAGONISTSASTHEDREAMSOFCONSERVATISMORTHEIMPOSTURESOFPLURALISTSINECURESINTHECHURCHHISTORYANDTRADITIONWHETHEROFANCIENTORCOMPARATIVELYRECENTTIMESARESUBJECTEDTOVERYDIFFERENTHANDLINGFROMTHATWHICHTHEINDULGENCEORCREDULITYOFFORMERAGESCOULDALLOWMERESTATEMENTSAREJEALOUSLYWATCHEDANDTHEMOTIVESOFTHEWRITERFORMASIMPORTANTANINGREDIENTINTHEANALYSISOFHISHISTORYASTHEFACTSHERECORDSPROBABILITYISAPOWERFULANDTROUBLESOMETESTANDITISBYTHISTROUBLESOMESTANDARDTHATALARGEPORTIONOFHISTORICALEVIDENCEISSIFTEDCONSISTENCYISNOLESSPERTINACIOUSANDEXACTINGINITSDEMANDSINBRIEFTOWRITEAHISTORYWEMUSTKNOWMORETHANMEREFACTSHUMANNATUREVIEWEDUNDERANINDUCTIONOFEXTENDEDEXPERIENCEISTHEBESTHELPTOTHECRITICISMOFHUMANHISTORYHISTORICALCHARACTERSCANONLYBEESTIMATEDBYTHESTANDARDWHICHHUMANEXPERIENCEWHETHERACTUALORTRADITIONARYHASFURNISHEDTOFORMCORRECTVIEWSOFINDIVIDUALSWEMUSTREGARDTHEMASFORMINGPARTSOFAGREATWHOLEWEMUSTMEASURETHEMBYTHEIRRELATIONTOTHEMASSOFBEINGSBYWHOMTHEYARESURROUNDEDANDINCONTEMPLATINGTHEINCIDENTSINTHEIRLIVESORCONDITIONWHICHTRADITIONHASHANDEDDOWNTOUSWEMUSTRATHERCONSIDERTHEGENERALBEARINGOFTHEWHOLENARRATIVETHANTHERESPECTIVEPROBABILITYOFITSDETAILS
For message 2, its key is "POIROT", and the plain text:
        
    THATPROCESSSAIDISTARTSUPONTHESUPPOSITIONTHATWHENYOUHAVEELIMINATEDALLWHICHISIMPOSSIBLETHENWHATEVERREMAINSHOWEVERIMPROBABLEMUSTBETHETRUTHITMAYWELLBETHATSEVERALEXPLANATIONSREMAININWHICHCASEONETRIESTESTAFTERTESTUNTILONEOROTHEROFTHEMHASACONVINCINGAMOUNTOFSUPPORTWEWILLNOWAPPLYTHISPRINCIPLETOTHECASEINPOINTASITWASFIRSTPRESENTEDTOMETHEREWERETHREEPOSSIBLEEXPLANATIONSOFTHESECLUSIONORINCARCERATIONOFTHISGENTLEMANINANOUTHOUSEOFHISFATHERSMANSIONTHEREWASTHEEXPLANATIONTHATHEWASINHIDINGFORACRIMEORTHATHEWASMADANDTHATTHEYWISHEDTOAVOIDANASYLUMORTHATHEHADSOMEDISEASEWHICHCAUSEDHISSEGREGATIONICOULDTHINKOFNOOTHERADEQUATESOLUTIONSTHESETHENHADTOBESIFTEDANDBALANCEDAGAINSTEACHOTHER
    